## Fingerprint Ridge Counting using Image Processing

This project focuses on estimating the number of ridges in fingerprint images through advanced image processing techniques. It aims to address the challenges posed by unclear images or images with noise, ensuring accurate ridge identification. The solution incorporates innovative thinking, experience, and extensive research to achieve robust processing and identification for various fingerprint images.

### Files and Libraries:

- **im2023sol.py**: This Python script contains the necessary code to perform ridge counting on fingerprint images. It includes functions for detecting a 120x120-pixel window containing the fingerprint and counting the number of ridges within that window.

- **input_images**: A folder that houses the fingerprint images to be processed. These images are in PNG format and have dimensions of 512x512 pixels.

- **out_images**: This folder stores the processed images generated by the code. Each processed image includes a red square of size 120x120 pixels, representing the fingerprint window, along with the corresponding ridge count. The processed images are saved in PNG format.

### Required Libraries:

- scipy
- numpy
- os
- cv2
- scikit-image

### Code Execution:

To execute the code, follow these steps:

1. Clone this repository to your local machine or Redmi device.
2. Install the required libraries listed above, if not already installed.
3. Open the cloned repository in your preferred Python development environment.
4. Run the "im2023sol.py" script to execute the code.
5. The processed images will be saved in the "out_images" folder.

### Project Overview:

The project involves the following steps and functions for fingerprint ridge counting:

1. **Normalize Image**: This function normalizes the input image, adjusting its data to have a defined mean and variance, thereby enhancing image quality.

2. **Segment Image**: The segment image function divides the image into blocks, generates a binary mask based on the standard deviation within each block, and applies morphological operations to obtain the final segmented fingerprint image, normalized image, and binary mask.

3. **Calculate Angles**: This function calculates slope angles for each window in the image by computing the gradient and slope angles using convolution and tangent formulas.

4. **Calculate Frequency**: This function determines the ridge frequency of an image by rotating the image, computing the column sum, applying noise reduction filters, and calculating the maximum frequency.

5. **Estimate Ridge Frequency**: This function estimates the ridge frequency in fingerprint images by analyzing the image in blocks, computing the frequency for each block, and returning the median frequency.

6. **Gabor Ridge Filter**: This function applies a Gabor filter to enhance ridge-like structures in a grayscale image, enabling precise identification of ridge direction and frequency.

7. **Skeletonize**: This function performs skeletonization on a grayscale image, resulting in a skeletonized representation of ridges.

8. **Minutiae At**: This function identifies minutiae types (ending, bifurcation, or none) at specific locations in a binary image based on neighboring pixel values.

9. **Calculate Minutiae**: This function calculates the number of minutiae in a grayscale fingerprint image by assigning weights to endings and bifurcations, and storing the counts in a 2D array.

10. **Count Lines**: This function determines the number of lines representing primary and secondary ridges in the image by scanning the main and secondary axes and counting transitions between black and white pixels.

11. **Draw Diagonal**: This function draws a line on the image, including the diagonal number and the word "ridges" below the line.

12. **Calculate Singularities**: This function detects the minimum number of minutiae problems within the smallest block covered by a mask, calculates the number of diagonals, and visualizes them on a copy of the original input image.

13. **Gender Fingerprint Pipeline**: This function processes the fingerprint image to find the optimal window for ridge counting. It executes a series of functions, including normalization, segmentation, angle calculation, ridge frequency estimation, Gabor filtering, skeletonization, minutiae calculation, and singularity detection.
